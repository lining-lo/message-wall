## 留言墙项目笔记

### 文档

- [Vite](https://vitejs.cn/vite5-cn/guide/)
- [Vue Router](https://router.vuejs.org/zh/guide/)
- [Element Plus](https://element-plus.org/zh-CN/#/zh-CN)
- [Vuex](https://vuex.vuejs.org/zh/)
- [Vant](https://vant-ui.github.io/vant/#/zh-CN)
- [Echarts](https://echarts.apache.org/zh/index.html)

### 目录

* [1. 项目初始化](#1-项目初始化)

#### 1. 项目初始化

```
1 初始化项目：npm install express --save
2 项目目录
	|-- serve/
		|-- jsconfig.json
		|-- index.js
		|-- 笔记.md
		|-- config/
		|	|-- default.js
		|-- controller/
		|-- lib/
		|	|-- db.js
		|-- routes/   
3 安装插件
	下载 mysql 插件（连接数据库）：npm install mysql --save
	下载 multer 插件（上传图片）：npm install multer --save
	下载 ejs 插件（解析 html）：npm install ejs --save
```

#### 2. 编写入口文件

```
1 入口模板：
    //引入express
    const express = require('express')
    //引入path
    const path = require('path')
    //引入ejs
    const ejs = require('ejs')
    //引入配置文件
    const config = require('./config/default')

    //创建express实例
    const app = express()

    //引入路由
    require('./routes/index')(app)
    require('./routes/files')(app)

    //设置静态资源位置
    app.use(express.static(__dirname + '/views'))
    app.use(express.static(__dirname + '/data'))

    //解析数据
    app.use(express.json())
    app.use(express.urlencoded({ extended: true }))

    //加入html视图
    app.engine('html', ejs.__express)
    app.set('view engine', 'html')

    //设置允许跨域访问该服务
    app.all('*', function (req, res, next) {
        //允许访问ip *为所有
        res.header("Access-Control-Allow-Origin", "*");
        res.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept");
        res.header("Access-Control-Allow-Credentials", "true");
        res.header("Access-Control-Allow-Methods", "PUT,POST,GET,DELETE,OPTIONS");
        req.header("X-Powered-By", '3.2.1')

        //这段仅仅为了方便返回json而已
        res.header("Content-Type", "application/json;charset=utf-8");
        if (req.method == 'OPTIONS') {
            //让options请求快速返回
            res.sendStatus(200);
        } else {
            next();
        }
    });

    //监听端口，启动项目
    app.listen(config.port, () => {
        console.log(`${config.port}端口监听中，项目启动`);
    })

2 启动项目：nodemon index
```

